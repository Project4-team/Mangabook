@using SachOnline.Models;
@model List<SessionGioHang>
@{
    ViewBag.Title = "GioHang";
    Layout = "~/Views/Layout/NoSideBarLayout.cshtml";
}
<!-- PAGE HEADER -->
<div class="page_header1">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <h5>Giỏ hàng</h5>
            </div>
        </div>
    </div>
</div>
<!-- CART TABLE CONTENT -->
<div class="col-md-12">
    <table class="cart-table">
        <thead>
            <tr>
                <th>Thông tin sách</th>
                <th>Số lượng</th>
                <th>Giá tiền</th>
                <th>Xoá</th>
            </tr>
        </thead>
        <tbody>
            @{
                foreach (var item in Model)
                {
                    <tr>
                        <td>
                            <img src="@Url.Content("~/Content/img-sp/"+item.iHinhAnh)" alt="" />
                            <h4><a href="@Url.Action("ChiTietSach","Sach",new { @masach=item.iMaSach})">@item.iTenSach</a></h4>
                            <div class="clearfix space20"></div>
                        </td>
                        <td>
                            <form>
                                <input type="text" value="@item.iSoLuong" class="Quanlity" id="product+@item.iMaSach" />
                            </form>
                        </td>
                        <td>
                            <div class="ps-price">@string.Format("{0:0,0 VNĐ}", item.iTongGia).Replace(",", ".")</div>
                        </td>
                        <td>
                            <a href="@Url.Action("XoaHang","GioHang",new { @masach=item.iMaSach})"><i class="fa fa-times close1"></i></a>
                        </td>
                    </tr>
                }
            }
        </tbody>
        <tfoot>
            <tr>
                <td></td>
                <td><span class="total-text">Tổng tiền thanh toán:</span></td>
                <td><span class="total-cart">@string.Format("{0:0,0 VNĐ}", ViewBag.TongGiaTien).Replace(",", ".")</span></td>
                <td><div class="scs-cart"><a href="~/dat-hang">Gửi đơn hàng</a></div></td>
            </tr>
        </tfoot>
    </table>

    <div class="space90"></div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $(".Quanlity").change(function () {
            var quanlity = $(this).val();
            var proID = $(this).attr("id");
            $.ajax({
                url: '@Url.Action("UpdateQuantity")',
                data: { "proID": proID, "quantity": quanlity }
            });
            window.location = '/GioHang';
        });
    });
</script>
